{"ast":null,"code":"import _slicedToArray from \"/Users/christophecaillet/Dev_local/React/grandcompte/leospa-main/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/christophecaillet/Dev_local/React/grandcompte/leospa-main/src/Components/RegisterComponent.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport \"../Login.css\";\nimport { getDatabase, ref, set, onValue, get, child } from \"firebase/database\";\nimport { toast } from \"react-toastify\";\nimport { auth, registerWithEmailAndPassword } from \"../firebase\";\n\nfunction useQuery() {\n  const _useLocation = useLocation(),\n        search = _useLocation.search;\n\n  return React.useMemo(() => new URLSearchParams(search), [search]);\n}\n\nfunction RegisterComponent() {\n  const _useState = useState(\"\"),\n        _useState2 = _slicedToArray(_useState, 2),\n        email = _useState2[0],\n        setEmail = _useState2[1];\n\n  const _useState3 = useState(\"\"),\n        _useState4 = _slicedToArray(_useState3, 2),\n        password = _useState4[0],\n        setPassword = _useState4[1];\n\n  const _useState5 = useState(\"\"),\n        _useState6 = _slicedToArray(_useState5, 2),\n        name = _useState6[0],\n        setName = _useState6[1];\n\n  const _useAuthState = useAuthState(auth),\n        _useAuthState2 = _slicedToArray(_useAuthState, 3),\n        user = _useAuthState2[0],\n        loading = _useAuthState2[1],\n        error = _useAuthState2[2];\n\n  const history = useHistory();\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        code = _useState8[0],\n        setCode = _useState8[1];\n\n  let query = useQuery();\n  const dbRef = ref(getDatabase());\n  const db = getDatabase();\n\n  const register = () => {\n    if (!name) alert(\"Merci d'entrer votre nom\");\n\n    if (!code) {\n      toast.warn(\"Vous devez contacter notre service client pour créer un compte !\", {\n        position: toast.POSITION.TOP_CENTER\n      });\n    } else {\n      registerWithEmailAndPassword(name, email, password);\n    }\n  };\n\n  useEffect(() => {\n    const code = query.get(\"code\");\n    setCode(code);\n\n    if (loading) {\n      // maybe trigger a loading screen\n      return;\n    }\n\n    if (user) {\n      if (code) {\n        // enregistrer uid prospect\n        get(child(dbRef, \"prospectEmail/\".concat(code))).then(snapshot => {\n          if (snapshot.exists()) {\n            const data = snapshot.val();\n            console.log(\"data\", data);\n            return;\n            set(ref(db, \"prospect/\" + user.uid), data);\n            toast.success(\"Votre compte a bien été créé !\", {\n              position: toast.POSITION.TOP_CENTER\n            });\n            history.push({\n              pathname: \"/prospect\",\n              search: \"?code=\" + code,\n              state: {\n                detail: data\n              }\n            });\n          } else {\n            console.log(\"No data available\");\n          }\n        });\n      } else {//history.push(\"/marketplace\");\n      }\n    }\n  }, [user, loading]);\n  return React.createElement(\"div\", {\n    className: \"register__container mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    className: \"register__textBox\",\n    value: name,\n    onChange: e => setName(e.target.value),\n    placeholder: \"Votre nom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"register__textBox\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    placeholder: \"Adresse E-mail\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"password\",\n    className: \"register__textBox\",\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    placeholder: \"Mot de passe\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    className: \"register__btn\",\n    onClick: register,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, \"S'enregistrer\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"D\\xE9j\\xE0 un compte ? \", React.createElement(Link, {\n    to: \"/?code=\" + code,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, \"Se connecter\"), \" \", \"maintenant.\"));\n}\n\nexport default RegisterComponent;","map":{"version":3,"sources":["/Users/christophecaillet/Dev_local/React/grandcompte/leospa-main/src/Components/RegisterComponent.js"],"names":["React","useEffect","useState","Link","useHistory","useLocation","useAuthState","getDatabase","ref","set","onValue","get","child","toast","auth","registerWithEmailAndPassword","useQuery","search","useMemo","URLSearchParams","RegisterComponent","email","setEmail","password","setPassword","name","setName","user","loading","error","history","code","setCode","query","dbRef","db","register","alert","warn","position","POSITION","TOP_CENTER","then","snapshot","exists","data","val","console","log","uid","success","push","pathname","state","detail","e","target","value"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,WAA3B,QAA8C,kBAA9C;AACA,SAASC,YAAT,QAA6B,2BAA7B;AACA,OAAO,cAAP;AACA,SAASC,WAAT,EAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,OAAhC,EAAyCC,GAAzC,EAA8CC,KAA9C,QAA2D,mBAA3D;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,IAAT,EAAeC,4BAAf,QAAmD,aAAnD;;AAEA,SAASC,QAAT,GAAoB;AAAA,uBACCX,WAAW,EADZ;AAAA,QACVY,MADU,gBACVA,MADU;;AAGlB,SAAOjB,KAAK,CAACkB,OAAN,CAAc,MAAM,IAAIC,eAAJ,CAAoBF,MAApB,CAApB,EAAiD,CAACA,MAAD,CAAjD,CAAP;AACD;;AAED,SAASG,iBAAT,GAA6B;AAAA,oBACDlB,QAAQ,CAAC,EAAD,CADP;AAAA;AAAA,QACpBmB,KADoB;AAAA,QACbC,QADa;;AAAA,qBAEKpB,QAAQ,CAAC,EAAD,CAFb;AAAA;AAAA,QAEpBqB,QAFoB;AAAA,QAEVC,WAFU;;AAAA,qBAGHtB,QAAQ,CAAC,EAAD,CAHL;AAAA;AAAA,QAGpBuB,IAHoB;AAAA,QAGdC,OAHc;;AAAA,wBAIIpB,YAAY,CAACQ,IAAD,CAJhB;AAAA;AAAA,QAIpBa,IAJoB;AAAA,QAIdC,OAJc;AAAA,QAILC,KAJK;;AAK3B,QAAMC,OAAO,GAAG1B,UAAU,EAA1B;;AAL2B,qBAMHF,QAAQ,CAAC,KAAD,CANL;AAAA;AAAA,QAMpB6B,IANoB;AAAA,QAMdC,OANc;;AAO3B,MAAIC,KAAK,GAAGjB,QAAQ,EAApB;AACA,QAAMkB,KAAK,GAAG1B,GAAG,CAACD,WAAW,EAAZ,CAAjB;AACA,QAAM4B,EAAE,GAAG5B,WAAW,EAAtB;;AAEA,QAAM6B,QAAQ,GAAG,MAAM;AACrB,QAAI,CAACX,IAAL,EAAWY,KAAK,CAAC,0BAAD,CAAL;;AACX,QAAI,CAACN,IAAL,EAAW;AACTlB,MAAAA,KAAK,CAACyB,IAAN,CACE,kEADF,EAEE;AACEC,QAAAA,QAAQ,EAAE1B,KAAK,CAAC2B,QAAN,CAAeC;AAD3B,OAFF;AAMD,KAPD,MAOO;AACL1B,MAAAA,4BAA4B,CAACU,IAAD,EAAOJ,KAAP,EAAcE,QAAd,CAA5B;AACD;AACF,GAZD;;AAcAtB,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM8B,IAAI,GAAGE,KAAK,CAACtB,GAAN,CAAU,MAAV,CAAb;AACAqB,IAAAA,OAAO,CAACD,IAAD,CAAP;;AACA,QAAIH,OAAJ,EAAa;AACX;AACA;AACD;;AACD,QAAID,IAAJ,EAAU;AACR,UAAII,IAAJ,EAAU;AACR;AACApB,QAAAA,GAAG,CAACC,KAAK,CAACsB,KAAD,0BAAyBH,IAAzB,EAAN,CAAH,CAA2CW,IAA3C,CAAiDC,QAAD,IAAc;AAC5D,cAAIA,QAAQ,CAACC,MAAT,EAAJ,EAAuB;AACrB,kBAAMC,IAAI,GAAGF,QAAQ,CAACG,GAAT,EAAb;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBH,IAApB;AACA;AACApC,YAAAA,GAAG,CAACD,GAAG,CAAC2B,EAAD,EAAK,cAAcR,IAAI,CAACsB,GAAxB,CAAJ,EAAkCJ,IAAlC,CAAH;AAEAhC,YAAAA,KAAK,CAACqC,OAAN,CAAc,gCAAd,EAAgD;AAC9CX,cAAAA,QAAQ,EAAE1B,KAAK,CAAC2B,QAAN,CAAeC;AADqB,aAAhD;AAGAX,YAAAA,OAAO,CAACqB,IAAR,CAAa;AACXC,cAAAA,QAAQ,EAAE,WADC;AAEXnC,cAAAA,MAAM,EAAE,WAAWc,IAFR;AAGXsB,cAAAA,KAAK,EAAE;AAAEC,gBAAAA,MAAM,EAAET;AAAV;AAHI,aAAb;AAKD,WAdD,MAcO;AACLE,YAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACD;AACF,SAlBD;AAmBD,OArBD,MAqBO,CACL;AACD;AACF;AACF,GAjCQ,EAiCN,CAACrB,IAAD,EAAOC,OAAP,CAjCM,CAAT;AAkCA,SACE;AAAK,IAAA,SAAS,EAAC,0BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,SAAS,EAAC,mBAFZ;AAGE,IAAA,KAAK,EAAEH,IAHT;AAIE,IAAA,QAAQ,EAAG8B,CAAD,IAAO7B,OAAO,CAAC6B,CAAC,CAACC,MAAF,CAASC,KAAV,CAJ1B;AAKE,IAAA,WAAW,EAAC,WALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAQE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,SAAS,EAAC,mBAFZ;AAGE,IAAA,KAAK,EAAEpC,KAHT;AAIE,IAAA,QAAQ,EAAGkC,CAAD,IAAOjC,QAAQ,CAACiC,CAAC,CAACC,MAAF,CAASC,KAAV,CAJ3B;AAKE,IAAA,WAAW,EAAC,gBALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARF,EAeE;AACE,IAAA,IAAI,EAAC,UADP;AAEE,IAAA,SAAS,EAAC,mBAFZ;AAGE,IAAA,KAAK,EAAElC,QAHT;AAIE,IAAA,QAAQ,EAAGgC,CAAD,IAAO/B,WAAW,CAAC+B,CAAC,CAACC,MAAF,CAASC,KAAV,CAJ9B;AAKE,IAAA,WAAW,EAAC,cALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAfF,EAsBE;AAAQ,IAAA,SAAS,EAAC,eAAlB;AAAkC,IAAA,OAAO,EAAErB,QAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAtBF,EAyBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCACmB,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,YAAYL,IAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADnB,EACmE,GADnE,gBAzBF,CADF;AAgCD;;AAED,eAAeX,iBAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport \"../Login.css\";\nimport { getDatabase, ref, set, onValue, get, child } from \"firebase/database\";\nimport { toast } from \"react-toastify\";\nimport { auth, registerWithEmailAndPassword } from \"../firebase\";\n\nfunction useQuery() {\n  const { search } = useLocation();\n\n  return React.useMemo(() => new URLSearchParams(search), [search]);\n}\n\nfunction RegisterComponent() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [user, loading, error] = useAuthState(auth);\n  const history = useHistory();\n  const [code, setCode] = useState(false);\n  let query = useQuery();\n  const dbRef = ref(getDatabase());\n  const db = getDatabase();\n\n  const register = () => {\n    if (!name) alert(\"Merci d'entrer votre nom\");\n    if (!code) {\n      toast.warn(\n        \"Vous devez contacter notre service client pour créer un compte !\",\n        {\n          position: toast.POSITION.TOP_CENTER,\n        }\n      );\n    } else {\n      registerWithEmailAndPassword(name, email, password);\n    }\n  };\n\n  useEffect(() => {\n    const code = query.get(\"code\");\n    setCode(code);\n    if (loading) {\n      // maybe trigger a loading screen\n      return;\n    }\n    if (user) {\n      if (code) {\n        // enregistrer uid prospect\n        get(child(dbRef, `prospectEmail/${code}`)).then((snapshot) => {\n          if (snapshot.exists()) {\n            const data = snapshot.val();\n            console.log(\"data\", data);\n            return;\n            set(ref(db, \"prospect/\" + user.uid), data);\n\n            toast.success(\"Votre compte a bien été créé !\", {\n              position: toast.POSITION.TOP_CENTER,\n            });\n            history.push({\n              pathname: \"/prospect\",\n              search: \"?code=\" + code,\n              state: { detail: data },\n            });\n          } else {\n            console.log(\"No data available\");\n          }\n        });\n      } else {\n        //history.push(\"/marketplace\");\n      }\n    }\n  }, [user, loading]);\n  return (\n    <div className=\"register__container mt-3\">\n      <input\n        type=\"text\"\n        className=\"register__textBox\"\n        value={name}\n        onChange={(e) => setName(e.target.value)}\n        placeholder=\"Votre nom\"\n      />\n      <input\n        type=\"text\"\n        className=\"register__textBox\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        placeholder=\"Adresse E-mail\"\n      />\n      <input\n        type=\"password\"\n        className=\"register__textBox\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Mot de passe\"\n      />\n      <button className=\"register__btn\" onClick={register}>\n        S'enregistrer\n      </button>\n      <div>\n        Déjà un compte ? <Link to={\"/?code=\" + code}>Se connecter</Link>{\" \"}\n        maintenant.\n      </div>\n    </div>\n  );\n}\n\nexport default RegisterComponent;\n"]},"metadata":{},"sourceType":"module"}