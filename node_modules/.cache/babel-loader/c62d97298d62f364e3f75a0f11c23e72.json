{"ast":null,"code":"import { initializeApp } from \"firebase/app\";\nimport { GoogleAuthProvider, getAuth, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, signOut, setPersistence, Persistence } from \"firebase/auth\";\nimport { getFirestore, query, getDocs, collection, where, addDoc } from \"firebase/firestore\";\nimport { getDatabase } from \"firebase/database\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyC7Ga1C0cD3_OD0nd_Dguu6qArqNQUbjHg\",\n  authDomain: \"unextra-prod.firebaseapp.com\",\n  databaseURL: \"https://unextra-prod-default-rtdb.europe-west1.firebasedatabase.app\",\n  projectId: \"unextra-prod\",\n  storageBucket: \"unextra-prod.appspot.com\",\n  messagingSenderId: \"705321915257\",\n  appId: \"1:705321915257:web:9cb3e910ef3f3a5d0e15a8\",\n  measurementId: \"G-L8FR6S8D9Z\"\n};\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getDatabase(app);\nconst googleProvider = new GoogleAuthProvider();\nexport const getTest = async () => {\n  const ref = db.ref(\"/annulations\");\n  const snapshot = await ref.once(\"value\");\n  return snapshot.val();\n};\n\nconst signInWithGoogle = async () => {\n  try {\n    const res = await signInWithPopup(auth, googleProvider);\n    const user = res.user;\n    const q = query(collection(db, \"users\"), where(\"uid\", \"==\", user.uid));\n    const docs = await getDocs(q);\n\n    if (docs.docs.length === 0) {\n      await addDoc(collection(db, \"users\"), {\n        uid: user.uid,\n        name: user.displayName,\n        authProvider: \"google\",\n        email: user.email\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logInWithEmailAndPassword = async (email, password) => {\n  try {\n    await setPersistence(auth.Auth.Persistence.SESSION);\n    await signInWithEmailAndPassword(auth, email, password);\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst registerWithEmailAndPassword = async (name, email, password) => {\n  try {\n    const res = await createUserWithEmailAndPassword(auth, email, password);\n    const user = res.user;\n    await addDoc(collection(db, \"users\"), {\n      uid: user.uid,\n      name,\n      authProvider: \"local\",\n      email\n    });\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst sendPasswordReset = async email => {\n  try {\n    await sendPasswordResetEmail(auth, email);\n    alert(\"Password reset link sent!\");\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logout = () => {\n  signOut(auth);\n};\n\nexport { auth, db, signInWithGoogle, logInWithEmailAndPassword, registerWithEmailAndPassword, sendPasswordReset, logout };","map":{"version":3,"sources":["/Users/christophecaillet/Dev_local/React/grandcompte/leospa-main/src/firebase.js"],"names":["initializeApp","GoogleAuthProvider","getAuth","signInWithPopup","signInWithEmailAndPassword","createUserWithEmailAndPassword","sendPasswordResetEmail","signOut","setPersistence","Persistence","getFirestore","query","getDocs","collection","where","addDoc","getDatabase","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","app","auth","db","googleProvider","getTest","ref","snapshot","once","val","signInWithGoogle","res","user","q","uid","docs","length","name","displayName","authProvider","email","err","console","error","alert","message","logInWithEmailAndPassword","password","Auth","SESSION","registerWithEmailAndPassword","sendPasswordReset","logout"],"mappings":"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","sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport {\n  GoogleAuthProvider,\n  getAuth,\n  signInWithPopup,\n  signInWithEmailAndPassword,\n  createUserWithEmailAndPassword,\n  sendPasswordResetEmail,\n  signOut,\n  setPersistence,\n  Persistence,\n} from \"firebase/auth\";\nimport {\n  getFirestore,\n  query,\n  getDocs,\n  collection,\n  where,\n  addDoc,\n} from \"firebase/firestore\";\n\nimport { getDatabase } from \"firebase/database\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyC7Ga1C0cD3_OD0nd_Dguu6qArqNQUbjHg\",\n  authDomain: \"unextra-prod.firebaseapp.com\",\n  databaseURL:\n    \"https://unextra-prod-default-rtdb.europe-west1.firebasedatabase.app\",\n  projectId: \"unextra-prod\",\n  storageBucket: \"unextra-prod.appspot.com\",\n  messagingSenderId: \"705321915257\",\n  appId: \"1:705321915257:web:9cb3e910ef3f3a5d0e15a8\",\n  measurementId: \"G-L8FR6S8D9Z\",\n};\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getDatabase(app);\n\nconst googleProvider = new GoogleAuthProvider();\n\nexport const getTest = async () => {\n  const ref = db.ref(`/annulations`);\n  const snapshot = await ref.once(\"value\");\n  return snapshot.val();\n};\n\nconst signInWithGoogle = async () => {\n  try {\n    const res = await signInWithPopup(auth, googleProvider);\n    const user = res.user;\n    const q = query(collection(db, \"users\"), where(\"uid\", \"==\", user.uid));\n    const docs = await getDocs(q);\n    if (docs.docs.length === 0) {\n      await addDoc(collection(db, \"users\"), {\n        uid: user.uid,\n        name: user.displayName,\n        authProvider: \"google\",\n        email: user.email,\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logInWithEmailAndPassword = async (email, password) => {\n  try {\n    await setPersistence(auth.Auth.Persistence.SESSION);\n    await signInWithEmailAndPassword(auth, email, password);\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst registerWithEmailAndPassword = async (name, email, password) => {\n  try {\n    const res = await createUserWithEmailAndPassword(auth, email, password);\n    const user = res.user;\n    await addDoc(collection(db, \"users\"), {\n      uid: user.uid,\n      name,\n      authProvider: \"local\",\n      email,\n    });\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst sendPasswordReset = async (email) => {\n  try {\n    await sendPasswordResetEmail(auth, email);\n    alert(\"Password reset link sent!\");\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logout = () => {\n  signOut(auth);\n};\n\nexport {\n  auth,\n  db,\n  signInWithGoogle,\n  logInWithEmailAndPassword,\n  registerWithEmailAndPassword,\n  sendPasswordReset,\n  logout,\n};\n"]},"metadata":{},"sourceType":"module"}